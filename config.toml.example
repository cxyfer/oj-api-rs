# OJ API Configuration

[server]
listen_addr = "0.0.0.0:7856"
admin_secret = "changeme"
graceful_shutdown_secs = 10

[database]
path = "data/data.db"
pool_max_size = 8
busy_timeout_ms = 5000

# LLM provider configuration (preferred over [gemini])
# Supported providers: "gemini", "openai"
[llm]
provider = "gemini"
api_key = ""
# base_url = ""  # optional, for proxy or custom endpoint

[llm.models.embedding]
name = "gemini-embedding-001"
dim = 768
task_type = "SEMANTIC_SIMILARITY"
batch_size = 32
# provider = ""  # optional, override global provider for embedding
# api_key = ""   # optional, override global api_key
# base_url = ""  # optional, override global base_url

[llm.models.rewrite]
name = "gemini-2.0-flash"
temperature = 0.3
timeout = 60
max_retries = 2
workers = 8
# provider = ""  # optional, override global provider for rewrite
# api_key = ""   # optional, override global api_key
# base_url = ""  # optional, override global base_url

# Legacy Gemini configuration (deprecated, use [llm] instead)
# If [llm] is present, [gemini] is ignored.
# [gemini]
# api_key = ""
# base_url = ""
#
# [gemini.models.embedding]
# name = "gemini-embedding-001"
# dim = 768
#
# [gemini.models.rewrite]
# name = "gemini-2.0-flash"

[crawler]
timeout_secs = 300
# user_agent = "Mozilla/5.0 (compatible; OJ-API-Bot/1.0)"
# proxy = "http://127.0.0.1:7890"         # shorthand for all protocols
# http_proxy = ""                          # HTTP-specific proxy
# https_proxy = ""                         # HTTPS-specific proxy
# socks5_proxy = ""                        # SOCKS5 proxy (requires aiohttp-socks)

# Per-crawler overrides (all fields optional, inherit from [crawler])
# [crawler.leetcode]
# user_agent = "..."
# https_proxy = "..."

# [crawler.codeforces]
# https_proxy = "..."
# NOTE: user_agent is ignored for codeforces (impersonate handles it)

# [crawler.atcoder]
# user_agent = "..."
# https_proxy = "..."

[embedding]
timeout_secs = 30           # per-query embed-text timeout (similar search)
over_fetch_factor = 4
concurrency = 4

[logging]
rust_log = "info"
level = "INFO"
